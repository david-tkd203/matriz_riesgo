<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Decreto Supremo N°44</title>

    <!-- Estilos base del sitio -->
    <link rel="stylesheet" href="style.css" />
    <!-- Estilos específicos de esta página -->
    <link rel="stylesheet" href="ds44.css" />

    <!-- Navbar / mega-menú (mismo que index) -->
    <script src="js/menu.js" defer></script>
    <!-- Render del índice DS44 (esta página) -->
    <script src="js/ds44_index.js" defer></script>
    <script src="js/ds44_manifest.js" defer></script>

</head>
<body>

    <!-- ======= BARRA DE MARCA (logos) ======= -->
    <header class="brandbar" role="banner">
        <div class="brandbar__inner container">
        <div class="brandbar__left">
            <img src="static/img/logo_cencosud.png" alt="Cencosud" class="brand-logo brand-logo--cenco" />
        </div>

        <div class="brandbar__title">
            <h1>Decreto Supremo N°44</h1>
            <p class="brandbar__subtitle">Índice y navegación por secciones</p>
        </div>

        <div class="brandbar__right">
            <img src="static/img/logo_ist.png" alt="IST" class="brand-logo brand-logo--ist" />
        </div>
        </div>
    </header>

    <!-- ======= NAVBAR SUPERIOR (atajos) ======= -->
    <nav class="subnav" role="navigation" aria-label="Índice principal">
        <div class="container subnav__inner">
        <ul class="subnav__list">
            <li class="subnav__item">
            <a class="subnav__link" href="index.html">Matriz de Riesgo</a>
            </li>

            <li class="subnav__item subnav__item--hasmenu">
            <!-- Enlace directo a esta misma página (activo) -->
            <a class="subnav__link is-active" href="ds44.html"><strong>Decreto Supremo N°44</strong></a>
            <!-- Botón sólo para abrir el mega-menú (si lo usas) -->
            <button class="subnav__toggle" type="button"
                    aria-haspopup="true" aria-expanded="false" aria-controls="menu-ds44"
                    title="Abrir menú DS44">
                <svg class="subnav__chev" width="12" height="12" viewBox="0 0 24 24" aria-hidden="true">
                <path d="M7 10l5 5 5-5" fill="none" stroke="currentColor" stroke-width="2"/>
                </svg>
            </button>

            <!-- Mega menú (opcional). Puedes poblarlo igual que en index si quieres. -->
            <div id="menu-ds44" class="mega" hidden>
                <div class="mega__scroll">
                <p class="muted small" style="margin:8px 0 0">Usa los accesos rápidos de abajo en la página.</p>
                </div>
            </div>
            </li>
        </ul>
        </div>
    </nav>

    <main class="container">
        <!-- Intro / explicación -->
        <section class="panel ds-hero">
        <h2 class="panel-title">¿Qué es el Decreto Supremo N°44?</h2>
        <p class="ds-lead">
            El <strong>Decreto Supremo N°44</strong> (Chile) establece lineamientos para la
            <strong>gestión de la Seguridad y Salud en el Trabajo (SST)</strong> dentro de las
            organizaciones. Orienta la implementación de una estructura de gestión con
            políticas, responsabilidades, identificación de peligros y evaluación de riesgos,
            programas de trabajo, seguimiento y mejora continua, participación del
            <abbr title="Comité Paritario de Higiene y Seguridad">CPHS</abbr>, entre otros.
        </p>
        <p class="muted small">
            En esta página encontrarás el <strong>índice de contenidos</strong> del DS 44 organizado por
            capítulos (1.1, 1.2, …), con accesos directos a cada sección. Al hacer clic,
            se abrirá la página de archivos <code>file.html</code> para explorar la documentación asociada.
        </p>
        </section>

        <!-- Accesos rápidos por sección -->
        <section class="panel">
        <h3 class="panel-title">Índice de secciones</h3>

        <!-- Aquí renderiza ds44_index.js -->
        <div id="ds44-toc" class="toc-grid" aria-live="polite">
            <!-- Contenido dinámico -->
        </div>
        </section>
    </main>

    <footer class="footer">
        <div class="container"><small>DS 44 · Cencosud & IST</small></div>
    </footer>
    <script>
    document.addEventListener('DOMContentLoaded', () => {
    const root = window.DS44_MANIFEST && window.DS44_MANIFEST['DS44_Root'];
    if (!root || !root.files || !root.files.length) return;

    const esc = (s)=> String(s||'')
        .replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));

    const panel = document.createElement('section');
    panel.className = 'panel';
    panel.innerHTML = `
        <h3 class="panel-title">Documentos generales</h3>
        <ul class="file-list" id="ds44-root-files"></ul>
    `;
    const toc = document.getElementById('ds44-toc');
    toc.parentNode.insertBefore(panel, toc);

    const ul = panel.querySelector('#ds44-root-files');

    root.files.forEach(f => {
        const href = encodeURI(f.path);
        const ext = (f.path.split('.').pop() || '').toLowerCase(); // pdf / potx, etc.
        const li = document.createElement('li');
        li.className = `file-item ext-${ext}`;

        li.innerHTML = `
        <span class="ficon" data-ext="${ext}" aria-hidden="true"></span>
        <div class="meta">
            <a class="title" href="${href}" download>${esc(f.name)}</a>
            ${f.desc ? `<small class="desc">${esc(f.desc)}</small>` : ``}
        </div>
        <div class="actions">
            <a class="btn-dl" href="${href}" download>
            Descargar
            </a>
        </div>
        `;
        ul.appendChild(li);
    });
    });
    </script>


</body>
</html>
